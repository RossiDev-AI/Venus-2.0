<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>V-NUS 2.0 | NATIVE</title>
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@tldraw/tldraw@2.4.4/dist/tldraw.css">
    
    <style>
        body, html, #root { 
            margin: 0; padding: 0; width: 100vw; height: 100vh; 
            overflow: hidden; background: #111; color: #fff;
            font-family: monospace;
        }
        #v-hud {
            position: fixed; inset: 0; display: flex; align-items: center;
            justify-content: center; background: #000; z-index: 999;
            pointer-events: none; transition: opacity 1s;
        }
    </style>
</head>
<body>

    <div id="v-hud">INICIALIZANDO NÚCLEO NATIVO...</div>
    <div id="root"></div>

    <script src="https://cdn.jsdelivr.net/npm/react@18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/react-dom@18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tldraw/tldraw@2.4.4/dist/tldraw.js"></script>

    <script>
        // Função de Boot Forçado
        function bootstrap() {
            try {
                const React = window.React;
                const ReactDOM = window.ReactDOM;
                // O tldraw global pode estar em window.tldraw ou window.tldraw.Tldraw
                const Tldraw = (window.tldraw && window.tldraw.Tldraw) ? window.tldraw.Tldraw : window.Tldraw;

                if (!Tldraw || !React || !ReactDOM) {
                    console.log("Aguardando pacotes...");
                    setTimeout(bootstrap, 500);
                    return;
                }

                const App = () => {
                    React.useEffect(() => {
                        const hud = document.getElementById('v-hud');
                        if (hud) hud.style.opacity = '0';
                        setTimeout(() => hud.style.display = 'none', 1000);
                    }, []);

                    return React.createElement('div', { style: { height: '100vh' } }, 
                        React.createElement(Tldraw, { 
                            inferDarkMode: true,
                            persistenceKey: "v-nus-v2-native-core"
                        })
                    );
                };

                const root = ReactDOM.createRoot(document.getElementById('root'));
                root.render(React.createElement(App));
                
            } catch (err) {
                document.getElementById('v-hud').innerHTML = "ERRO CRÍTICO: " + err.message;
            }
        }

        // Inicia o processo
        bootstrap();
    </script>
</body>
</html>