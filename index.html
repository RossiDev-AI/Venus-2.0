<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>V-NUS 2.0 | CORE</title>
    
    <link rel="stylesheet" href="https://unpkg.com/tldraw@2.4.4/dist/tldraw.css">
    
    <style>
        body, html, #root { 
            margin: 0; 
            padding: 0; 
            width: 100vw; 
            height: 100vh; 
            overflow: hidden; 
            background: #000; 
            color: #fff;
            font-family: sans-serif;
        }
        #status-overlay {
            position: fixed;
            inset: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #000;
            z-index: 9999;
            transition: opacity 0.5s;
        }
    </style>

    <script src="https://unpkg.com/react@18.2.0/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/tldraw@2.4.4/dist/tldraw.js"></script>
</head>
<body>

    <div id="status-overlay">CONECTANDO AO KERNEL V-NUS...</div>
    <div id="root"></div>

    <script>
        window.onload = () => {
            const React = window.React;
            const ReactDOM = window.ReactDOM;
            
            // Tenta capturar o Tldraw de todas as formas possíveis que o Global oferece
            const TldrawComponent = (window.tldraw && window.tldraw.Tldraw) ? window.tldraw.Tldraw : window.Tldraw;

            if (!TldrawComponent) {
                document.getElementById('status-overlay').innerHTML = "<span style='color:red'>ERRO: MOTOR GRÁFICO NÃO CARREGADO</span>";
                return;
            }

            function VenusApp() {
                React.useEffect(() => {
                    console.log("V-NUS 2.0: SISTEMA OPERACIONAL ATIVO");
                    // Pequeno delay para suavizar a entrada
                    setTimeout(() => {
                        const overlay = document.getElementById('status-overlay');
                        if(overlay) overlay.style.opacity = '0';
                        setTimeout(() => overlay ? overlay.style.display = 'none' : null, 500);
                    }, 1000);
                }, []);

                return React.createElement('div', { 
                    style: { position: 'fixed', inset: 0 } 
                }, 
                    React.createElement(TldrawComponent, { 
                        inferDarkMode: true,
                        persistenceKey: "v-nus-v2-final-stable"
                    })
                );
            }

            try {
                const root = ReactDOM.createRoot(document.getElementById('root'));
                root.render(React.createElement(VenusApp));
            } catch (e) {
                document.getElementById('status-overlay').innerText = "FALHA NA RENDERIZAÇÃO: " + e.message;
            }
        };
    </script>
</body>
</html>